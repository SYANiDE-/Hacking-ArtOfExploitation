#include <stdio.h>
#include <stdlib.h>
#include <string.h>

void usage(int checkthis, char** vector){
	if (checkthis < 2){
		printf("USAGE: %s [string]\n", vector[0]);
		exit(-1);
	}
}

int check_auth(char *pass){
	int authed = 0;		// if defined BEFORE passbuf, would be placed on the stack BEFORE passbuf
						//, and could then overflow into authed and make value non-zero, granting access
						//, by the IF statement around check_auth in main()
	char passbuf[16];
	strcpy(passbuf, pass);
	if(strcmp(passbuf,"whatever") == 0){
		authed = 1;
	}
	if(strcmp(passbuf,"something") ==0){
		authed = 1;
	}
	return authed;
}

int main(int argc, char* argv[]){
	usage(argc,argv);
	if(check_auth(argv[1])){				// note
		printf("[!] Access GRANTED\n");
	}else{
		printf("[!] Access DENIED\n");
	}
}

