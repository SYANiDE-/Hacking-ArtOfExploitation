; Chase Hatch 2019 playing with this again
; Just a MIC CHECK!
; ; x86_64 parameters order: rdi, rsi, rdx, r10, r8, and r9
; nasm -f elf64 exit_64.nasm -o exit_64.o
; ld exit_64.o -o exit_64.elf
; gcc -fno-stack-protector executor3.c -o executor3.elf
; ./executor3.elf "\x48\x31\xc0\x48\x31\xff\xb0\x3c\x0f\x05"  ## clean exit 

section .text
global _start
_start:

	; exit(0);
	xor rax,rax
	xor rdi,rdi
	mov al, 60	;exit
	syscall


;;;  fgrep exit /usr/include/asm/unistd_64.h 
;;;  #define __NR_exit 60
;;;  
;;;  objdump -d exit_64.nasm
;;;  0000000000401000 <_start>:
;;;    401000:       48 31 c0                xor    %rax,%rax
;;;    401003:       48 31 ff                xor    %rdi,%rdi
;;;    401006:       b0 3c                   mov    $0x3c,%al
;;;    401008:       0f 05                   syscall
;;;  
;;;  echo """\
;;;   48 31 c0
;;;   48 31 ff
;;;   b0 3c   
;;;   0f 05   """ |tr -d $'\n' |sed -re 's/[ ]+/ /g' -e 's/[ ]+$//g' -e 's/\ /\\x/g' ;echo ""
;;;  \x48\x31\xc0\x48\x31\xff\xb0\x3c\x0f\x05

