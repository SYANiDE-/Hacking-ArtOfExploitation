#include <stdio.h>
#include <string.h>

/* Fun with pointers, casting, and string formatting
 * cheatsheet
 */


int main(){
   char char_arr[3] = {'z', 'n', 'k'};
   int int_arr[3] = {27983, 6924111, 32};
   char *char_pt;
   int *int_pt;
   void *void_ptr;
   int i; 
   unsigned raw_int;
   char_pt = char_arr;
   int_pt = int_arr;
   printf("%s", "pointers\n");
   // print char arr; addr is val
   for(i=0; i<3; i++){
      printf("%p is %c\n", char_pt, *char_pt);
      char_pt = char_pt + 1;
   }
   // print int arr: addr is val
   for(i=0; i<3; i++){
      printf("%p is %i\n", int_pt, *int_pt);
      int_pt = int_pt + 1;
   }
   // typecasting pointers.  Pointers point to memory addresses
   // they therefore hold memory addresses.
   // chars are 1 byte
   // ints are 4 bytes
   // incrementing an int pointer-to-char would increment four bytes
   // ... without cast
   // Note the cast of int_pt as an int pointer to char array, 
   // then incrementing by casting the int_ptr to char pointer and
   // adding 1, then casting the value back to int pointer
   // // iterating over a char array using an int pointer
   printf("%s", "// typecasting pointers.\n// using Int pointer to char arr\n");
   int_pt = (int *) char_arr; 
   for(i=0; i<3; i++){
      printf("%p is %c\n", int_pt, *int_pt);
      int_pt = (int *)((char *) int_pt + 1);
   }
   // void pointer to int arr.
   // Note the explicit cast everywhere its use is not related to memory
   printf("%s", "// using void pointer. \n// iterating int array using void pointer\n");
   void_ptr = (int *) int_arr;
   for(i=0; i<3; i++){
      printf("%p is %i\n", void_ptr, *((int *) void_ptr));
      void_ptr = (void *) ((int *) void_ptr + 1);
   }
   // raw integer as pointer (holds address)
   // note the pointer is unsigned int
   // note the assignment as casting what to point to as unsigned int
   // dereferencing requires casting as pointer-to, datatype-of-array pointer
   // to the unsigned int
   printf("%s", "// raw integer as pointer (holds address)\n");
   raw_int = (unsigned int) char_arr;
   for(i=0; i<3; i++){
      printf("%p is %c\n", raw_int, *((char *) raw_int));
      raw_int =  raw_int + sizeof(char);
   }
   // fun with strings
   printf("%s", "// fun with strings\n");
   char str_a[400];
   char *pointer;
   strcpy(str_a, "This is a test of the emergency broadcast system.\n");
   pointer = str_a;
   printf(pointer);
   pointer = pointer + 22;
   strcpy(pointer, "rewrite.\n");
   pointer = str_a;
   printf(pointer);
   return(0);
}

